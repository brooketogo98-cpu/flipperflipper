<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="csrf-token" content="{{ csrf_token() }}">
    <title>Stitch - Real-Time Control</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style_real.css') }}">
    <script src="https://cdn.socket.io/4.5.4/socket.io.min.js"></script>
</head>
<body>
    <div class="dashboard">
        <nav class="sidebar">
            <div class="sidebar-header">
                <h2>‚ö° STITCH</h2>
                <p class="version">Real-Time Interface v1.0</p>
            </div>
            
            <ul class="nav-menu">
                <li><a href="#" class="nav-link active" data-section="connections">
                    <span>üîå</span> Connections
                </a></li>
                <li><a href="#" class="nav-link" data-section="commands">
                    <span>‚ö°</span> Commands
                </a></li>
                <li><a href="#" class="nav-link" data-section="files">
                    <span>üìÅ</span> Files
                </a></li>
                <li><a href="#" class="nav-link" data-section="logs">
                    <span>üìã</span> Debug Logs
                </a></li>
            </ul>
            
            <div class="sidebar-footer">
                <div class="connection-status">
                    <span class="status-dot online" id="serverStatus"></span>
                    <span id="statusText">Server Online</span>
                </div>
                <a href="{{ url_for('logout') }}" class="logout-btn">Logout</a>
            </div>
        </nav>
        
        <main class="main-content">
            <!-- Connections Section -->
            <section id="connections-section" class="content-section active">
                <div class="section-header">
                    <h1>üéØ Active Connections Dashboard</h1>
                    <p>Real-time connection status - Click any connection to execute commands</p>
                </div>
                
                <div class="loading-indicator" id="statusLoadingIndicator">
                    <div class="loading-spinner"></div>
                    <span class="text">Loading server status...</span>
                </div>
                
                <div class="server-status-card">
                    <div class="status-item">
                        <span class="status-label">Server Status:</span>
                        <span class="status-value" id="serverListening">Loading...</span>
                    </div>
                    <div class="status-item">
                        <span class="status-label">Listening Port:</span>
                        <span class="status-value" id="serverPort">Loading...</span>
                    </div>
                    <div class="status-item">
                        <span class="status-label">Active Connections:</span>
                        <span class="status-value online-count" id="activeCount">0</span>
                    </div>
                </div>
                
                <div class="connections-header">
                    <h2>Connections</h2>
                    <button class="refresh-btn" onclick="loadConnections()">
                        üîÑ Refresh
                    </button>
                </div>
                
                <div class="loading-indicator" id="connectionsLoadingIndicator">
                    <div class="loading-spinner"></div>
                    <span class="text">Loading connections...</span>
                </div>
                
                <div class="connections-grid" id="connectionsGrid">
                    <div class="loading-state">
                        <p>‚è≥ Loading connections...</p>
                    </div>
                </div>
            </section>
            
            <!-- Commands Section -->
            <section id="commands-section" class="content-section">
                <div class="section-header">
                    <h1>‚ö° Command Execution</h1>
                    <p>Execute real commands on connected targets</p>
                </div>
                
                <div class="selected-connection-info" id="selectedConnectionInfo">
                    <p>‚ÑπÔ∏è Select a connection from the Connections tab first</p>
                </div>
                
                <div class="command-interface">
                    <div class="command-categories">
                        <button class="cat-btn active" onclick="showCommands('system')">System Info</button>
                        <button class="cat-btn" onclick="showCommands('files')">File Operations</button>
                        <button class="cat-btn" onclick="showCommands('network')">Network</button>
                        <button class="cat-btn" onclick="showCommands('security')">Security</button>
                        <button class="cat-btn" onclick="showCommands('admin')">Administrative</button>
                        <button class="cat-btn" onclick="showCommands('custom')">Custom</button>
                    </div>
                    
                    <div id="systemCommands" class="command-group active">
                        <h3>System Information</h3>
                        <div class="command-buttons">
                            <button class="cmd-btn" onclick="executeCommand('sysinfo')">System Info</button>
                            <button class="cmd-btn" onclick="executeCommand('environment')">Environment</button>
                            <button class="cmd-btn" onclick="executeCommand('ps')">Processes</button>
                            <button class="cmd-btn" onclick="executeCommand('drives')">Drives</button>
                            <button class="cmd-btn" onclick="executeCommand('location')">Location</button>
                            <button class="cmd-btn" onclick="executeCommand('pwd')">Working Dir</button>
                            <button class="cmd-btn" onclick="executeCommand('ls')">List Files</button>
                        </div>
                    </div>
                    
                    <div id="filesCommands" class="command-group">
                        <h3>File Operations</h3>
                        <div class="command-buttons">
                            <button class="cmd-btn" onclick="executeCommandWithParam('download')">Download File</button>
                            <button class="cmd-btn" onclick="executeCommandWithParam('upload')">Upload File</button>
                            <button class="cmd-btn" onclick="executeCommandWithParam('cat')">View File</button>
                            <button class="cmd-btn" onclick="executeCommandWithParam('cd')">Change Dir</button>
                            <button class="cmd-btn" onclick="executeCommandWithParam('touch')">Create File</button>
                        </div>
                    </div>
                    
                    <div id="networkCommands" class="command-group">
                        <h3>Network Commands</h3>
                        <div class="command-buttons">
                            <button class="cmd-btn" onclick="executeCommand('ipconfig')">IP Config</button>
                            <button class="cmd-btn" onclick="executeCommand('firewall status')">Firewall Status</button>
                            <button class="cmd-btn" onclick="executeCommand('hostsfile show')">Show Hosts File</button>
                        </div>
                    </div>
                    
                    <div id="securityCommands" class="command-group">
                        <h3>Security & Stealth</h3>
                        <div class="command-buttons">
                            <button class="cmd-btn" onclick="executeCommand('screenshot')">Screenshot</button>
                            <button class="cmd-btn" onclick="executeCommand('keylogger status')">Keylogger Status</button>
                            <button class="cmd-btn" onclick="executeCommand('avscan')">AV Scan</button>
                            <button class="cmd-btn" onclick="executeCommand('webcamlist')">List Webcams</button>
                        </div>
                    </div>
                    
                    <div id="adminCommands" class="command-group">
                        <h3>Administrative</h3>
                        <div class="command-buttons">
                            <button class="cmd-btn" onclick="executeCommand('sessions')">Sessions</button>
                            <button class="cmd-btn" onclick="executeCommand('history')">History</button>
                            <button class="cmd-btn" onclick="executeCommand('showkey')">Show Keys</button>
                        </div>
                    </div>
                    
                    <div id="customCommands" class="command-group">
                        <h3>Custom Command</h3>
                        <div class="custom-command-input">
                            <input type="text" id="customCommandInput" placeholder="Enter command..." onkeypress="if(event.key==='Enter') executeCustomCommand()">
                            <button class="cmd-btn" onclick="executeCustomCommand()">Execute</button>
                        </div>
                    </div>
                    
                    <div class="command-output">
                        <div class="output-header">
                            <h3>Command Output</h3>
                            <div class="output-actions">
                                <button class="clear-btn" onclick="copyOutput()">üìã Copy</button>
                                <button class="clear-btn" onclick="clearOutput()">Clear</button>
                            </div>
                        </div>
                        <pre id="commandOutput">Ready to execute commands...</pre>
                    </div>
                </div>
            </section>
            
            <!-- Files Section -->
            <section id="files-section" class="content-section">
                <div class="section-header">
                    <h1>üìÅ Downloaded Files</h1>
                    <p>Files downloaded from connected targets</p>
                </div>
                
                <div class="loading-indicator" id="filesLoadingIndicator">
                    <div class="loading-spinner"></div>
                    <span class="text">Loading files...</span>
                </div>
                
                <div class="files-grid" id="filesGrid">
                    <div class="loading-state">
                        <p>‚è≥ Loading files...</p>
                    </div>
                </div>
            </section>
            
            <!-- Logs Section -->
            <section id="logs-section" class="content-section">
                <div class="section-header">
                    <h1>üìã Debug Logs</h1>
                    <p>Real-time system logs</p>
                </div>
                
                <div class="loading-indicator" id="logsLoadingIndicator">
                    <div class="loading-spinner"></div>
                    <span class="text">Loading logs...</span>
                </div>
                
                <div class="logs-container">
                    <div class="logs-header">
                        <button class="refresh-btn" onclick="loadLogs()">üîÑ Refresh</button>
                        <button class="clear-btn" onclick="document.getElementById('debugLogs').innerHTML = ''">Clear</button>
                    </div>
                    <div id="debugLogs" class="logs-output">
                        <p class="log-entry">System initialized...</p>
                    </div>
                </div>
            </section>
        </main>
    </div>
    
    <div id="toast-container"></div>
    
    <script src="{{ url_for('static', filename='js/app_real.js') }}"></script>
</body>
</html>
